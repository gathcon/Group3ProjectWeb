<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link href='http://fonts.googleapis.com/css?family=Maven+Pro:400,500' rel='stylesheet' type='text/css'>
	
<script>

	function getPhoneModels(url) {

		try {
			var JSONRequest = new XMLHttpRequest();

			JSONRequest.open("GET", url, false);
			JSONRequest.send(null);

			var txt = JSONRequest.responseText;
			var obj = eval("(" + txt + ")");

			var size = obj.length;

			var mySelector = "<select id='modelSelector'>";

			for (var i = 0; i < size; i++) {

				var model = obj[i].userEquipment.model;

				mySelector += "<option value=i>" + model + "</option>";
			}
			mySelector += "</select>";

			document.getElementById("selectorspace").innerHTML = mySelector;


		} catch (err) {
			document.getElementById("msg").innerHTML = "No phone models available.";
		}
	}

	function processData(){

		var selector = document.getElementById("modelSelector");
		var model = selector.options[selector.selectedIndex].text;	

		getJSON('jaxrs/base_Datas/FailureCountByModelAndByDateRange/' 
				+ model + '/' 
				+ document.getElementById('startdatetime').value + '/' 
				+ document.getElementById('enddatetime').value);
		}

	function getJSON(url) {

		try {
			var JSONRequest = new XMLHttpRequest();

			JSONRequest.open("GET", url, false);
			JSONRequest.send(null);

			var txt = JSONRequest.responseText;
			var obj = eval("(" + txt + ")");

			document.getElementById("msg").innerHTML = "The number of failures for this phone model and date range";
			document.getElementById("count").innerHTML = obj;

		} catch (err) {
			document.getElementById("msg").innerHTML = "No record found for inputs submitted.";
		}
	}
</script>
</head>

<body onload="getPhoneModels('jaxrs/base_Datas/allPhoneModels/')">
	<div id="logo">
		<img src="Ericsson.png">
	</div>

	<div id="heading">
		<h1>Get the count of failures for a phone model between date range</h1>
	</div>

	<div id="menu">
		<ul>
			<li><a class="menulinks">Home</a></li>
			<li><a class="menulinks">Logout</a></li>
		</ul>
	</div>
	
	<div id="mainbody">
		<form name='inputForm'>
			<fieldset>
				
				<label for=selectorspace>Phone Model:</label> 
				<span id="selectorspace"></span> <br> 
				<label for="startdatetime">Start DateTime:</label> 
				<input type="datetime-local" id="startdatetime" name="startDate">
				<label for="enddatetime">End DateTime:</label> 
				<input type="datetime-local" id="enddatetime" name="endDate"> 
				<label for="submit"></label> 
				<input type="button" name="submit" onclick="processData()"
					value="Query" size="20">
			</fieldset>
		</form>

		</br>
		</br>

		<p id="msg"></p>
		<p id="count"></p>
	</div>
</body>

</body>
</html>
